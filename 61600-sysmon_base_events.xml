<!--
  Standalone Sysmon Base Event Parent Rules (Events 1-15)

  This file provides standalone parent rules for Sysmon Events 1-15 for use with StoW.
  These rules are normally included in Wazuh's base ruleset (0595-win-sysmon_rules.xml),
  but are provided here for standalone deployments or development environments.

  Rule ID Range: 61600-61617 (18 parent rules)

  Dependencies:
  - Wazuh agent must be configured to collect Microsoft-Windows-Sysmon/Operational logs
  - Sysmon must be installed and running on Windows endpoints

  Deployment:
  1. Copy to Wazuh Manager: sudo cp 61600-sysmon_base_events.xml /var/ossec/etc/rules/
  2. Add to ossec.conf: <include>61600-sysmon_base_events.xml</include>
  3. Restart Wazuh Manager: systemctl restart wazuh-manager

  Note: If you're using Wazuh's official ruleset (wazuh-ruleset package), these rules
  are already included and you DON'T need this file. This is only for standalone StoW
  deployments or custom Wazuh configurations.

  References:
  - Wazuh Sysmon Rules: https://github.com/wazuh/wazuh-ruleset/blob/master/rules/0595-win-sysmon_rules.xml
  - Sysmon Documentation: https://docs.microsoft.com/en-us/sysinternals/downloads/sysmon
-->

<group name="windows,sysmon,">

  <!-- Base Sysmon Channel Rule - Matches all Sysmon Operational events -->
  <rule id="61600" level="0">
    <field name="win.system.channel" type="pcre2">(?i)^Microsoft-Windows-Sysmon/Operational$</field>
    <description>Windows Sysmon informational event</description>
    <options>no_full_log</options>
    <group>sysmon,</group>
  </rule>

  <!-- Sysmon Event 1: Process Creation -->
  <rule id="61603" level="0">
    <if_sid>61600</if_sid>
    <field name="win.system.eventID">^1$</field>
    <description>Sysmon - Event 1: Process creation $(win.eventdata.image)</description>
    <options>no_full_log</options>
    <group>sysmon_event1,sysmon_process-anomalies,</group>
  </rule>

  <!-- Sysmon Event 2: File Creation Time Changed -->
  <rule id="61604" level="0">
    <if_sid>61600</if_sid>
    <field name="win.system.eventID">^2$</field>
    <description>Sysmon - Event 2: A process changed a file creation time by $(win.eventdata.image)</description>
    <options>no_full_log</options>
    <group>sysmon_event2,</group>
  </rule>

  <!-- Sysmon Event 3: Network Connection -->
  <rule id="61605" level="0">
    <if_sid>61600</if_sid>
    <field name="win.system.eventID">^3$</field>
    <description>Sysmon - Event 3: Network connection by $(win.eventdata.image)</description>
    <options>no_full_log</options>
    <group>sysmon_event3,</group>
  </rule>

  <!-- Sysmon Event 4: Sysmon Service State Changed -->
  <rule id="61606" level="0">
    <if_sid>61600</if_sid>
    <field name="win.system.eventID">^4$</field>
    <description>Sysmon - Event 4: Sysmon service state changed</description>
    <options>no_full_log</options>
    <group>sysmon_event4,</group>
  </rule>

  <!-- Sysmon Event 5: Process Terminated -->
  <rule id="61607" level="0">
    <if_sid>61600</if_sid>
    <field name="win.system.eventID">^5$</field>
    <description>Sysmon - Event 5: Process terminated $(win.eventdata.image)</description>
    <options>no_full_log</options>
    <group>sysmon_event5,</group>
  </rule>

  <!-- Sysmon Event 6: Driver Loaded -->
  <rule id="61608" level="0">
    <if_sid>61600</if_sid>
    <field name="win.system.eventID">^6$</field>
    <description>Sysmon - Event 6: Driver loaded $(win.eventdata.imageLoaded)</description>
    <options>no_full_log</options>
    <group>sysmon_event6,</group>
  </rule>

  <!-- Sysmon Event 7: Image Loaded (DLL) -->
  <rule id="61609" level="0">
    <if_sid>61600</if_sid>
    <field name="win.system.eventID">^7$</field>
    <description>Sysmon - Event 7: Image loaded by $(win.eventdata.image)</description>
    <options>no_full_log</options>
    <group>sysmon_event7,</group>
  </rule>

  <!-- Sysmon Event 8: CreateRemoteThread -->
  <rule id="61610" level="0">
    <if_sid>61600</if_sid>
    <field name="win.system.eventID">^8$</field>
    <description>Sysmon - Event 8: CreateRemoteThread by $(win.eventdata.sourceImage)</description>
    <options>no_full_log</options>
    <group>sysmon_event8,</group>
  </rule>

  <!-- Sysmon Event 9: RawAccessRead -->
  <rule id="61611" level="0">
    <if_sid>61600</if_sid>
    <field name="win.system.eventID">^9$</field>
    <description>Sysmon - Event 9: RawAccessRead by $(win.eventdata.image)</description>
    <options>no_full_log</options>
    <group>sysmon_event9,</group>
  </rule>

  <!-- Sysmon Event 10: Process Access -->
  <rule id="61612" level="0">
    <if_sid>61600</if_sid>
    <field name="win.system.eventID">^10$</field>
    <description>Sysmon - Event 10: ProcessAccess by $(win.eventdata.sourceImage)</description>
    <options>no_full_log</options>
    <group>sysmon_event_10,</group>
  </rule>

  <!-- Sysmon Event 11: File Create -->
  <rule id="61613" level="0">
    <if_sid>61600</if_sid>
    <field name="win.system.eventID">^11$</field>
    <description>Sysmon - Event 11: FileCreate by $(win.eventdata.image)</description>
    <options>no_full_log</options>
    <group>sysmon_event_11,</group>
  </rule>

  <!-- Sysmon Event 12: Registry Object Create/Delete -->
  <rule id="61614" level="0">
    <if_sid>61600</if_sid>
    <field name="win.system.eventID">^12$</field>
    <description>Sysmon - Event 12: RegistryEvent (Object create and delete) by $(win.eventdata.image)</description>
    <options>no_full_log</options>
    <group>sysmon_event_12,sysmon_registry,</group>
  </rule>

  <!-- Sysmon Event 13: Registry Value Set -->
  <rule id="61615" level="0">
    <if_sid>61600</if_sid>
    <field name="win.system.eventID">^13$</field>
    <description>Sysmon - Event 13: RegistryEvent (Value Set) by $(win.eventdata.image)</description>
    <options>no_full_log</options>
    <group>sysmon_event_13,sysmon_registry,</group>
  </rule>

  <!-- Sysmon Event 14: Registry Key/Value Rename -->
  <rule id="61616" level="0">
    <if_sid>61600</if_sid>
    <field name="win.system.eventID">^14$</field>
    <description>Sysmon - Event 14: RegistryEvent (Key and Value Rename) by $(win.eventdata.image)</description>
    <options>no_full_log</options>
    <group>sysmon_event_14,sysmon_registry,</group>
  </rule>

  <!-- Sysmon Event 15: File Create Stream Hash (Alternate Data Streams) -->
  <rule id="61617" level="0">
    <if_sid>61600</if_sid>
    <field name="win.system.eventID">^15$</field>
    <description>Sysmon - Event 15: FileCreateStreamHash by $(win.eventdata.image)</description>
    <options>no_full_log</options>
    <group>sysmon_event_15,</group>
  </rule>

</group>
