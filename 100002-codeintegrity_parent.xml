<!--
  Parent Rule for Windows Code Integrity Events

  Provides base rule for Code Integrity policy violations, unsigned drivers,
  and revoked certificate detections from the Microsoft-Windows-CodeIntegrity/Operational channel.

  Required:
  - Channel must be enabled on Windows:
    wevtutil sl Microsoft-Windows-CodeIntegrity/Operational /e:true

  Common Event IDs:
  - 3001: Unsigned kernel module loaded
  - 3004: Code integrity check failed
  - 3023: Revoked driver blocked
  - 3033-3037: Revoked/unsigned image events
  - 3076-3077: Policy violation events
  - 3082-3083: WHQL requirement failures
  - 3089: Code integrity policy load/unload
  - 3099: Code integrity policy modification
  - 3104: Blocked file for protected processes

  Rule ID: 109998 (Custom parent rule for Code Integrity)
-->

<group name="windows,codeintegrity,">

  <!-- Parent rule for all Code Integrity events -->
  <rule id="109998" level="3">
    <field name="win.system.channel">Microsoft-Windows-CodeIntegrity/Operational</field>
    <description>Windows Code Integrity Event</description>
    <options>no_full_log</options>
    <group>windows,codeintegrity-operational,</group>
  </rule>

</group>
