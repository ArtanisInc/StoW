<!--
  Parent Rule for Windows DNS Server Events

  Provides base rule for DNS Server events from the
  Microsoft-Windows-DNS-Server/Analytical or Audit channels.

  Required:
  - Channel must be enabled on Windows Server:
    wevtutil sl Microsoft-Windows-DNS-Server/Analytical /e:true
    wevtutil sl Microsoft-Windows-DNS-Server/Audit /e:true

  Common Event IDs:
  - 150: DNS zone transfer requested
  - 770: DNS zone transfer completed
  - 771: DNS zone transfer failed
  - 541: DNS server plugin DLL loaded

  Use Cases:
  - Detect DNS zone transfer attempts (reconnaissance)
  - Monitor suspicious DNS server plugins
  - Track DNS server configuration changes
  - Detect DNS cache poisoning attempts

  Rule ID: 109992 (Custom parent rule for DNS Server)
-->

<group name="windows,dns-server,">

  <!-- Parent rule for all DNS Server events -->
  <rule id="109992" level="3">
    <field name="win.system.channel" type="pcre2">Microsoft-Windows-DNS-Server/(Analytical|Audit)</field>
    <description>Windows DNS Server Event</description>
    <options>no_full_log</options>
    <group>windows,dns-server,</group>
  </rule>

</group>
